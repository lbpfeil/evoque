---
phase: 02-component-migration
plan: 04
type: execute
wave: 3
depends_on: ["02-01"]
files_modified:
  - pages/Highlights.tsx
  - components/HighlightTableRow.tsx
  - components/TagManagerSidebar.tsx
autonomous: true

must_haves:
  truths:
    - "Highlights page renders correctly in both light and dark mode"
    - "Table headers and rows use semantic tokens"
    - "Toolbar, filters, and pagination use semantic tokens"
    - "TagManagerSidebar uses semantic tokens"
    - "Bulk action toolbar uses semantic tokens"
  artifacts:
    - path: "pages/Highlights.tsx"
      provides: "Highlights page with semantic tokens"
      contains: "bg-card text-card-foreground"
    - path: "components/HighlightTableRow.tsx"
      provides: "Table row with semantic tokens"
      contains: "hover:bg-accent"
    - path: "components/TagManagerSidebar.tsx"
      provides: "Tag sidebar with semantic tokens"
      contains: "bg-card border-border"
  key_links:
    - from: "pages/Highlights.tsx"
      to: "components/HighlightTableRow.tsx"
      via: "component import"
      pattern: "HighlightTableRow"
---

<objective>
Migrate Highlights.tsx and related components to use semantic color tokens.

Purpose: Highlights is the most complex page (558 lines) with many interactive elements - toolbar, filters, table, pagination, bulk actions. This establishes the pattern for data-heavy pages.

Output: Fully theme-aware Highlights page with all sub-components rendering correctly in both light and dark mode.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-component-migration/02-RESEARCH.md

# Files to migrate
@pages/Highlights.tsx
@components/HighlightTableRow.tsx
@components/TagManagerSidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Highlights.tsx to semantic tokens</name>
  <files>pages/Highlights.tsx</files>
  <action>
  Apply semantic token replacements throughout the file:

  **Background colors:**
  - `bg-white` -> `bg-card`
  - `bg-zinc-50` -> `bg-muted`
  - `bg-zinc-100` -> `bg-muted`
  - `dark:bg-zinc-900` -> REMOVE
  - `dark:bg-zinc-950` -> REMOVE
  - `dark:bg-zinc-800` -> REMOVE

  **Text colors:**
  - `text-zinc-900` -> `text-card-foreground`
  - `text-zinc-800` -> `text-foreground`
  - `text-zinc-700` -> `text-foreground`
  - `text-zinc-600` -> `text-muted-foreground`
  - `text-zinc-500` -> `text-muted-foreground`
  - `text-zinc-400` -> `text-muted-foreground`
  - `dark:text-zinc-*` -> REMOVE all variants

  **Border colors:**
  - `border-zinc-200` -> `border-border`
  - `border-zinc-300` -> `border-border`
  - `dark:border-zinc-*` -> REMOVE all variants

  **Hover states:**
  - `hover:bg-zinc-50` -> `hover:bg-muted`
  - `hover:bg-zinc-100` -> `hover:bg-accent`
  - `hover:bg-zinc-200` -> `hover:bg-accent`
  - `dark:hover:bg-zinc-*` -> REMOVE all variants
  - `hover:border-zinc-300` -> `hover:border-primary/30`
  - `hover:border-zinc-400` -> `hover:border-primary/30`

  **Focus states:**
  - `focus:ring-blue-500` -> `focus:ring-ring`
  - `focus:border-blue-500` -> `focus:border-ring`

  **Primary/accent colors:**
  - `bg-blue-600` -> `bg-primary`
  - `bg-blue-500` -> `bg-primary`
  - `hover:bg-blue-700` -> `hover:bg-primary/90`
  - `text-blue-600` -> `text-primary`
  - `text-blue-500` -> `text-primary`
  - `dark:bg-blue-*` -> REMOVE

  **Destructive colors:**
  - `bg-red-500` -> `bg-destructive`
  - `hover:bg-red-600` -> `hover:bg-destructive/90`
  - `text-red-500` -> `text-destructive`
  - `text-red-600` -> `text-destructive`

  **Pagination buttons pattern:**
  ```tsx
  // REPLACE typical pagination button
  className="flex items-center gap-1 px-3 py-1.5 rounded-md border border-zinc-200 dark:border-zinc-800 text-sm font-medium disabled:opacity-50"
  // WITH
  className="flex items-center gap-1 px-3 py-1.5 rounded-md border border-border text-sm font-medium hover:bg-accent transition-colors duration-200 disabled:opacity-50"
  ```

  **Table header pattern:**
  ```tsx
  // Ensure table headers use
  className="... bg-muted text-muted-foreground ..."
  ```

  **Selection checkbox area:**
  Ensure selected state uses `bg-primary/10` or `bg-accent`

  Add `transition-colors duration-200` to all interactive elements without transitions.
  </action>
  <verify>
  - Run: `npm run build` (no errors)
  - Grep: `grep -c "zinc-" pages/Highlights.tsx` shows significant reduction
  </verify>
  <done>
  - Highlights.tsx has minimal hardcoded colors
  - Toolbar, filters, table, pagination use semantic tokens
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate HighlightTableRow.tsx and TagManagerSidebar.tsx</name>
  <files>components/HighlightTableRow.tsx, components/TagManagerSidebar.tsx</files>
  <action>
  **HighlightTableRow.tsx:**

  Apply same replacement patterns as Task 1:
  - `bg-white` -> `bg-card`
  - `bg-zinc-*` -> appropriate semantic token
  - `text-zinc-*` -> `text-foreground` or `text-muted-foreground`
  - `border-zinc-*` -> `border-border`
  - `hover:bg-zinc-*` -> `hover:bg-accent`
  - Remove all `dark:` prefixes

  **Row hover pattern:**
  ```tsx
  // Ensure row has
  className="... hover:bg-accent transition-colors duration-200 ..."
  ```

  **Selected row pattern:**
  ```tsx
  // Selected state should use
  className="... bg-primary/5 ..."
  ```

  **TagManagerSidebar.tsx:**

  Apply same replacement patterns:
  - Container: `bg-card border-border`
  - Headers: `text-card-foreground`
  - Items: `text-foreground` with `hover:bg-accent`
  - Muted text: `text-muted-foreground`
  - Input fields: `bg-background border-input`

  **Tag item pattern:**
  ```tsx
  // REPLACE
  className="... bg-zinc-100 text-zinc-700 ..."
  // WITH
  className="... bg-muted text-muted-foreground ..."
  ```

  **Active/selected tag:**
  ```tsx
  // Use
  className="... bg-primary/10 text-primary ..."
  ```

  Add `transition-colors duration-200` to interactive elements.
  </action>
  <verify>
  - Run: `npm run build` (no errors)
  - Grep: `grep -c "zinc-" components/HighlightTableRow.tsx components/TagManagerSidebar.tsx` returns 0
  - Visual: Open /highlights, toggle theme, verify table and sidebar render correctly
  </verify>
  <done>
  - HighlightTableRow.tsx has 0 hardcoded zinc-* colors
  - TagManagerSidebar.tsx has 0 hardcoded zinc-* colors
  - Both components render correctly in light and dark mode
  </done>
</task>

<task type="auto">
  <name>Task 3: Final cleanup and verification of Highlights page</name>
  <files>pages/Highlights.tsx, components/HighlightTableRow.tsx, components/TagManagerSidebar.tsx</files>
  <action>
  **Run comprehensive grep to find remaining issues:**
  ```bash
  grep -n "zinc-\|blue-[0-9]\|dark:" pages/Highlights.tsx components/HighlightTableRow.tsx components/TagManagerSidebar.tsx
  ```

  **For each remaining instance:**
  1. Identify the context
  2. Apply appropriate semantic token
  3. Remove orphaned dark: prefixes

  **Common patterns that may need manual attention:**

  1. **Checkbox styling:**
  If custom checkbox styles exist, ensure they use:
  - `border-input` for border
  - `bg-primary` for checked state
  - `text-primary-foreground` for check icon

  2. **Dropdown/select menus:**
  Ensure they use popover tokens:
  - `bg-popover text-popover-foreground border-border`

  3. **Badge/tag colors:**
  Some tags may have specific colors (chapter tags, etc.):
  - Keep semantic where possible
  - For colored tags, ensure dark mode variants exist

  4. **Empty state:**
  If there's an empty state illustration/message:
  - Use `text-muted-foreground` for text
  - Use `bg-muted` for background

  5. **Bulk action toolbar:**
  When items are selected:
  - Background: `bg-primary/10`
  - Text: `text-primary`
  - Buttons: Follow standard button patterns
  </action>
  <verify>
  - Run: `grep -c "zinc-" pages/Highlights.tsx components/HighlightTableRow.tsx components/TagManagerSidebar.tsx` returns 0
  - Run: `npm run build` (no errors)
  - Visual: Full testing of Highlights page in both modes
    - Load page, verify table renders
    - Select items, verify bulk actions appear correctly
    - Open tag sidebar, verify it renders
    - Use filters, verify dropdowns work
    - Paginate, verify buttons work
    - Toggle theme throughout all interactions
  </verify>
  <done>
  - All Highlights-related files have 0 hardcoded zinc-* colors
  - Page and all components render correctly in both light and dark mode
  - All interactive elements have proper hover/focus states with transitions
  </done>
</task>

</tasks>

<verification>
Run after all tasks complete:

```bash
# Verify no hardcoded colors remain
grep -rn "zinc-" pages/Highlights.tsx components/HighlightTableRow.tsx components/TagManagerSidebar.tsx

# Expected: No output

# Build check
npm run build

# Visual verification
npm run dev
# Navigate to Highlights (/highlights or /#/highlights)
# Test all interactions in both light and dark mode:
# - Table rendering
# - Row selection
# - Bulk actions
# - Tag sidebar
# - Filters
# - Pagination
```
</verification>

<success_criteria>
- Highlights.tsx has 0 hardcoded zinc-* colors
- HighlightTableRow.tsx has 0 hardcoded zinc-* colors
- TagManagerSidebar.tsx has 0 hardcoded zinc-* colors
- All components render correctly in light and dark mode
- Interactive elements have proper transitions (duration-200)
- No TypeScript errors on build
</success_criteria>

<output>
After completion, create `.planning/phases/02-component-migration/02-04-SUMMARY.md`
</output>
