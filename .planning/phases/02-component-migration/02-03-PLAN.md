---
phase: 02-component-migration
plan: 03
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - pages/Settings.tsx
autonomous: true

must_haves:
  truths:
    - "Settings page renders correctly in both light and dark mode"
    - "All tabs (Import, Library, Account, Preferences) use semantic tokens"
    - "Parser imports (lines 82-136) are UNTOUCHED"
    - "Settings page has no hardcoded zinc-* colors in JSX"
  artifacts:
    - path: "pages/Settings.tsx"
      provides: "Settings page with semantic tokens"
      contains: "bg-card text-card-foreground"
  key_links:
    - from: "pages/Settings.tsx"
      to: "index.css"
      via: "semantic CSS variables"
      pattern: "(bg|text|border)-(background|foreground|muted|card|border)"
---

<objective>
Migrate Settings.tsx to use semantic color tokens while preserving parser import logic.

Purpose: Settings is the longest page (797 lines) with extensive zinc-* usage but straightforward replacements. CRITICAL: Lines 82-136 contain parser imports that must NOT be modified.

Output: Theme-aware Settings page with all 4 tabs rendering correctly in both light and dark mode.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-component-migration/02-RESEARCH.md

# Page file to migrate
@pages/Settings.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Settings.tsx tab structure and Import tab</name>
  <files>pages/Settings.tsx</files>
  <action>
  **CRITICAL CONSTRAINT:** DO NOT modify lines 82-136 (parser import logic). Only modify JSX className attributes.

  Use search and replace for the following patterns throughout the ENTIRE file:

  **Background colors:**
  - `bg-white` -> `bg-card`
  - `bg-zinc-50` -> `bg-muted`
  - `bg-zinc-100` -> `bg-muted`
  - `dark:bg-zinc-900` -> REMOVE (not needed with semantic tokens)
  - `dark:bg-zinc-950` -> REMOVE
  - `dark:bg-zinc-800` -> REMOVE

  **Text colors:**
  - `text-zinc-900` -> `text-card-foreground` (for card titles/headings)
  - `text-zinc-800` -> `text-foreground`
  - `text-zinc-700` -> `text-foreground`
  - `text-zinc-600` -> `text-muted-foreground`
  - `text-zinc-500` -> `text-muted-foreground`
  - `text-zinc-400` -> `text-muted-foreground`
  - `dark:text-zinc-100` -> REMOVE
  - `dark:text-zinc-200` -> REMOVE
  - `dark:text-zinc-300` -> REMOVE
  - `dark:text-zinc-400` -> REMOVE
  - `dark:text-zinc-500` -> REMOVE

  **Border colors:**
  - `border-zinc-200` -> `border-border`
  - `border-zinc-300` -> `border-border`
  - `dark:border-zinc-800` -> REMOVE
  - `dark:border-zinc-700` -> REMOVE

  **Hover states:**
  - `hover:bg-zinc-50` -> `hover:bg-muted`
  - `hover:bg-zinc-100` -> `hover:bg-accent`
  - `hover:bg-zinc-200` -> `hover:bg-accent`
  - `dark:hover:bg-zinc-800` -> REMOVE
  - `dark:hover:bg-zinc-700` -> REMOVE
  - `hover:border-zinc-300` -> `hover:border-primary/30`
  - `hover:border-zinc-400` -> `hover:border-primary/30`
  - `dark:hover:border-zinc-600` -> REMOVE
  - `dark:hover:border-zinc-700` -> REMOVE

  **Focus states:**
  - `focus:ring-blue-500` -> `focus:ring-ring`
  - `focus:border-blue-500` -> `focus:border-ring`

  **Accent/primary colors:**
  - `bg-blue-600` -> `bg-primary`
  - `bg-blue-500` -> `bg-primary`
  - `hover:bg-blue-700` -> `hover:bg-primary/90`
  - `hover:bg-blue-600` -> `hover:bg-primary/90`
  - `text-blue-600` -> `text-primary`
  - `text-blue-500` -> `text-primary`
  - `dark:bg-blue-500` -> REMOVE
  - `dark:hover:bg-blue-600` -> REMOVE

  **Destructive colors (keep red for delete actions):**
  - `bg-red-500` -> `bg-destructive`
  - `bg-red-600` -> `bg-destructive`
  - `hover:bg-red-600` -> `hover:bg-destructive/90`
  - `hover:bg-red-700` -> `hover:bg-destructive/90`
  - `text-red-500` -> `text-destructive`
  - `text-red-600` -> `text-destructive`
  - `dark:bg-red-600` -> REMOVE
  - `dark:hover:bg-red-700` -> REMOVE

  **Success colors:**
  - `bg-green-50` -> `bg-green-500/10` (keep green for success states)
  - `border-green-200` -> `border-green-500/30`
  - `text-green-700` -> `text-green-600 dark:text-green-400`
  - `text-green-600` -> `text-green-600 dark:text-green-400`

  **Error/warning states:**
  - `bg-red-50` -> `bg-destructive/10`
  - `border-red-200` -> `border-destructive/30`
  - `text-red-700` -> `text-destructive`
  - `text-red-800` -> `text-destructive`

  Add transition utilities where hover states exist:
  - Add `transition-colors duration-200` to interactive elements without transitions
  </action>
  <verify>
  - Run: `npm run build` (no errors)
  - Verify parser imports untouched: `sed -n '82,136p' pages/Settings.tsx` should show original parser logic
  - Grep check: `grep -n "zinc-" pages/Settings.tsx | head -20` shows significantly fewer matches
  </verify>
  <done>
  - Settings.tsx tab structure uses semantic tokens
  - Import tab uses semantic tokens
  - Parser imports (lines 82-136) are UNCHANGED
  </done>
</task>

<task type="auto">
  <name>Task 2: Clean up remaining hardcoded colors in Settings.tsx</name>
  <files>pages/Settings.tsx</files>
  <action>
  After Task 1's bulk replacement, manually verify and fix any remaining hardcoded colors.

  **Run grep to find remaining issues:**
  ```bash
  grep -n "zinc-\|blue-[0-9]\|dark:" pages/Settings.tsx
  ```

  **For each remaining instance:**
  1. Identify the context (what component/section)
  2. Apply the appropriate semantic token
  3. Remove any orphaned `dark:` prefixes

  **Common patterns that may need manual fixing:**

  1. **Tab buttons (active state):**
  If you see `bg-black text-white dark:bg-white dark:text-black`:
  -> Keep as is (this is the inverted contrast pattern, intentional)

  2. **Disabled states:**
  If you see `disabled:bg-zinc-100`:
  -> Replace with `disabled:bg-muted disabled:text-muted-foreground`

  3. **Drag area (Import tab):**
  If you see special drag states:
  -> Use `bg-primary/5 border-primary` for active drag state

  4. **Avatar placeholder:**
  If you see `bg-blue-600` for avatar:
  -> Keep as is (brand color for avatar is intentional)

  5. **Input fields with specific sizing:**
  Ensure all inputs have: `bg-background text-foreground border-input`

  **Verify the file structure:**
  - Lines 1-81: Imports and state (may have minor color refs - OK)
  - Lines 82-136: PROTECTED parser logic (DO NOT TOUCH)
  - Lines 137+: JSX (all zinc-* should be replaced)
  </action>
  <verify>
  - Run: `grep -c "zinc-" pages/Settings.tsx` returns 0 or very low number (only in protected parser area)
  - Run: `npm run build` (no errors)
  - Visual: Open /settings, check all 4 tabs in both light and dark mode
  </verify>
  <done>
  - Settings.tsx has minimal/no hardcoded zinc-* colors in JSX
  - All 4 tabs render correctly in both modes
  - Parser imports remain unchanged
  - Page is fully theme-aware
  </done>
</task>

</tasks>

<verification>
Run after all tasks complete:

```bash
# Check parser imports are untouched (should see parsePDFKindleHighlights, parseAnkiTSV, parseMyClippings)
sed -n '82,136p' pages/Settings.tsx | grep -E "import\(|parser"

# Count remaining hardcoded colors (should be 0 or minimal)
grep -c "zinc-" pages/Settings.tsx

# Build check
npm run build

# Visual verification
npm run dev
# Navigate to Settings (/settings or /#/settings)
# Check each tab: Import, Library, Account, Preferences
# Toggle theme on each tab
```
</verification>

<success_criteria>
- Settings.tsx has 0 hardcoded zinc-* colors in JSX (outside protected lines)
- Parser imports (lines 82-136) are completely unchanged
- All 4 tabs render correctly in light and dark mode
- Interactive elements have proper hover/focus states
- No TypeScript errors on build
</success_criteria>

<output>
After completion, create `.planning/phases/02-component-migration/02-03-SUMMARY.md`
</output>
