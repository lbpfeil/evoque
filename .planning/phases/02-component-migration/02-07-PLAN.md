---
phase: 02-component-migration
plan: 07
type: execute
wave: 1
depends_on: []
files_modified:
  - components/DashboardCharts.tsx
  - components/TagSelector.tsx
  - components/StudyStatusBadge.tsx
  - components/HighlightStats.tsx
  - components/ErrorBoundary.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "DashboardCharts renders correctly in both light and dark mode"
    - "TagSelector uses semantic tokens throughout"
    - "StudyStatusBadge 'Not Started' state uses semantic tokens"
    - "HighlightStats uses semantic tokens (or is removed if orphaned)"
    - "ErrorBoundary uses semantic tokens"
  artifacts:
    - path: "components/DashboardCharts.tsx"
      provides: "Charts with theme-aware colors"
      contains: "bg-card"
    - path: "components/TagSelector.tsx"
      provides: "Tag selector with semantic tokens"
      contains: "text-muted-foreground"
    - path: "components/StudyStatusBadge.tsx"
      provides: "Status badge with semantic tokens"
      contains: "bg-muted"
    - path: "components/ErrorBoundary.tsx"
      provides: "Error boundary with semantic tokens"
      contains: "bg-background"
  key_links:
    - from: "pages/Dashboard.tsx"
      to: "components/DashboardCharts.tsx"
      via: "lazy import"
      pattern: "DashboardCharts"
    - from: "components/HighlightTableRow.tsx"
      to: "components/TagSelector.tsx"
      via: "component import"
      pattern: "TagSelector"
    - from: "components/HighlightTableRow.tsx"
      to: "components/StudyStatusBadge.tsx"
      via: "component import"
      pattern: "StudyStatusBadge"
---

<objective>
Close verification gaps by migrating 5 remaining components to semantic color tokens.

Purpose: Verification found that while main pages were migrated, 5 child/utility components still have hardcoded zinc colors. This causes theme inconsistencies when using Dashboard and Highlights pages.

Output: All Phase 2 components use semantic tokens, achieving COLOR-04 requirement compliance.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-component-migration/02-VERIFICATION.md
@.planning/STATE.md

# Files to migrate
@components/DashboardCharts.tsx
@components/TagSelector.tsx
@components/StudyStatusBadge.tsx
@components/HighlightStats.tsx
@components/ErrorBoundary.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate DashboardCharts.tsx to semantic tokens</name>
  <files>components/DashboardCharts.tsx</files>
  <action>
  **Tailwind class replacements (lines 13, 14, 34, 35):**

  Container divs:
  - `bg-white dark:bg-zinc-900` -> `bg-card`
  - `border-zinc-200 dark:border-zinc-800` -> `border-border`

  Headings:
  - `text-zinc-900 dark:text-zinc-100` -> `text-card-foreground`

  **Recharts hardcoded hex colors (theme-aware approach):**

  Per decision [02-06]: Use `hsl(var(--primary))` for Recharts colors.

  Replace hardcoded hex values with CSS variable references:

  Line 20-21 (linearGradient stops):
  - `stopColor="#000000"` -> `stopColor="hsl(var(--foreground))"`

  Line 24 (CartesianGrid stroke):
  - `stroke="#E4E4E7"` -> `stroke="hsl(var(--border))"`

  Line 25-26 (XAxis/YAxis tick fill):
  - `fill: '#71717a'` -> `fill: 'hsl(var(--muted-foreground))'`

  Line 27 (Tooltip):
  - `backgroundColor: '#18181b'` -> `backgroundColor: 'hsl(var(--popover))'`
  - `color: '#fff'` -> `color: 'hsl(var(--popover-foreground))'`
  - `cursor={{stroke: '#e4e4e7'}}` -> `cursor={{stroke: 'hsl(var(--border))'}}`

  Line 28 (Area stroke):
  - `stroke="#18181b"` -> `stroke="hsl(var(--primary))"`

  Line 39 (CartesianGrid stroke):
  - `stroke="#E4E4E7"` -> `stroke="hsl(var(--border))"`

  Line 41 (YAxis tick fill):
  - `fill: '#71717a'` -> `fill: 'hsl(var(--muted-foreground))'`

  Line 42 (Tooltip cursor):
  - `cursor={{fill: '#f4f4f5'}}` -> `cursor={{fill: 'hsl(var(--muted))'}}`

  Line 43 (Bar fill):
  - `fill="#27272a"` -> `fill="hsl(var(--primary))"`
  </action>
  <verify>
  - Run: `grep -c "zinc-" components/DashboardCharts.tsx` returns 0
  - Run: `grep -c "#[0-9a-fA-F]" components/DashboardCharts.tsx` returns 0 (no hardcoded hex)
  - Run: `npm run build` (no errors)
  </verify>
  <done>
  - DashboardCharts.tsx has 0 hardcoded zinc-* colors
  - DashboardCharts.tsx has 0 hardcoded hex colors
  - Charts render correctly in both light and dark mode
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate TagSelector.tsx, StudyStatusBadge.tsx, and handle HighlightStats.tsx</name>
  <files>components/TagSelector.tsx, components/StudyStatusBadge.tsx, components/HighlightStats.tsx</files>
  <action>
  **TagSelector.tsx replacements:**

  Line 103 (empty state text):
  - `text-zinc-500` -> `text-muted-foreground`

  Line 176 (button hover):
  - `hover:bg-zinc-100` -> `hover:bg-accent`

  Line 187 (global tag styling):
  - `bg-zinc-100 text-zinc-700 border-zinc-200 dark:bg-zinc-800 dark:text-zinc-300 dark:border-zinc-700`
  - Replace with: `bg-muted text-muted-foreground border-border`

  Line 197 (placeholder text):
  - `text-zinc-400` -> `text-muted-foreground`

  Line 222 (empty state text in popover):
  - `text-zinc-500` -> `text-muted-foreground`

  **StudyStatusBadge.tsx replacement:**

  Line 36 (Not Started status):
  - `bg-zinc-50 dark:bg-zinc-800/50` -> `bg-muted`
  - `text-zinc-500 dark:text-zinc-500` -> `text-muted-foreground`
  - `border-zinc-200 dark:border-zinc-800` -> `border-border`

  Full replacement:
  ```tsx
  // FROM:
  <span className={cn("... bg-zinc-50 dark:bg-zinc-800/50 text-zinc-500 dark:text-zinc-500 ... border border-zinc-200 dark:border-zinc-800", className)}>

  // TO:
  <span className={cn("... bg-muted text-muted-foreground ... border border-border", className)}>
  ```

  **HighlightStats.tsx:**

  First, verify the component is orphaned by checking for imports:
  ```bash
  grep -r "HighlightStats" --include="*.tsx" --include="*.ts" | grep -v "HighlightStats.tsx" | grep -v ".planning"
  ```

  If NO imports found (component is orphaned):
  - Delete the file: `rm components/HighlightStats.tsx`
  - This is cleanup, not migration

  If imports ARE found:
  - Apply standard semantic token replacements:
    - `bg-white dark:bg-zinc-900` -> `bg-card`
    - `border-zinc-200 dark:border-zinc-800` -> `border-border`
    - `text-zinc-900 dark:text-zinc-100` -> `text-card-foreground`
    - `text-zinc-400 dark:text-zinc-500` -> `text-muted-foreground`
    - `bg-zinc-200 dark:bg-zinc-800` (dividers) -> `bg-border`
  </action>
  <verify>
  - Run: `grep -c "zinc-" components/TagSelector.tsx` returns 0
  - Run: `grep -c "zinc-" components/StudyStatusBadge.tsx` returns 0
  - Run: `ls components/HighlightStats.tsx 2>/dev/null || echo "deleted"` - either deleted or migrated
  - Run: `npm run build` (no errors)
  </verify>
  <done>
  - TagSelector.tsx has 0 hardcoded zinc-* colors
  - StudyStatusBadge.tsx has 0 hardcoded zinc-* colors
  - HighlightStats.tsx is either deleted (if orphaned) or migrated
  </done>
</task>

<task type="auto">
  <name>Task 3: Migrate ErrorBoundary.tsx to semantic tokens</name>
  <files>components/ErrorBoundary.tsx</files>
  <action>
  **ErrorBoundary.tsx replacements:**

  Line 30 (page background):
  - `bg-zinc-50` -> `bg-background`

  Line 31 (card styling):
  - `bg-white` -> `bg-card`
  - `border border-zinc-200` -> `border border-border`

  Line 35 (heading):
  - `text-zinc-900` -> `text-foreground`

  Line 36 (paragraph):
  - `text-zinc-500` -> `text-muted-foreground`

  Line 41 (error details background):
  - `bg-zinc-50` -> `bg-muted`

  Line 50 (button):
  - `bg-black text-white ... hover:bg-zinc-800` -> `bg-primary text-primary-foreground ... hover:bg-primary/90`

  Full error section replacement for clarity:
  ```tsx
  // FROM line 30-31:
  <div className="min-h-screen flex items-center justify-center bg-zinc-50 p-4">
    <div className="bg-white p-8 rounded-lg shadow-xl max-w-md w-full text-center border border-zinc-200">

  // TO:
  <div className="min-h-screen flex items-center justify-center bg-background p-4">
    <div className="bg-card p-8 rounded-lg shadow-xl max-w-md w-full text-center border border-border">
  ```

  ```tsx
  // FROM line 35-36:
  <h1 className="text-2xl font-bold text-zinc-900 mb-2">Something went wrong</h1>
  <p className="text-zinc-500 mb-6 text-sm leading-relaxed">

  // TO:
  <h1 className="text-2xl font-bold text-foreground mb-2">Something went wrong</h1>
  <p className="text-muted-foreground mb-6 text-sm leading-relaxed">
  ```

  ```tsx
  // FROM line 41:
  <div className="mb-6 p-3 bg-zinc-50 rounded text-left overflow-auto max-h-32">

  // TO:
  <div className="mb-6 p-3 bg-muted rounded text-left overflow-auto max-h-32">
  ```

  ```tsx
  // FROM line 48-50:
  <button
    onClick={() => window.location.reload()}
    className="w-full py-3 bg-black text-white rounded-md font-medium hover:bg-zinc-800 transition-colors flex items-center justify-center gap-2"

  // TO:
  <button
    onClick={() => window.location.reload()}
    className="w-full py-3 bg-primary text-primary-foreground rounded-md font-medium hover:bg-primary/90 transition-colors flex items-center justify-center gap-2"
  ```
  </action>
  <verify>
  - Run: `grep -c "zinc-" components/ErrorBoundary.tsx` returns 0
  - Run: `grep -c "bg-black" components/ErrorBoundary.tsx` returns 0
  - Run: `npm run build` (no errors)
  </verify>
  <done>
  - ErrorBoundary.tsx has 0 hardcoded zinc-* colors
  - ErrorBoundary.tsx has 0 hardcoded bg-black colors
  - Error boundary renders correctly in both light and dark mode
  </done>
</task>

</tasks>

<verification>
Run after all tasks complete:

```bash
# Verify no hardcoded colors remain in any gap closure components
grep -rn "zinc-" components/DashboardCharts.tsx components/TagSelector.tsx components/StudyStatusBadge.tsx components/ErrorBoundary.tsx

# Expected: No output

# Verify no hardcoded hex colors in DashboardCharts
grep -n "#[0-9a-fA-F]" components/DashboardCharts.tsx

# Expected: No output

# Verify HighlightStats is either deleted or migrated
ls components/HighlightStats.tsx 2>/dev/null && grep -c "zinc-" components/HighlightStats.tsx || echo "HighlightStats deleted"

# Build check
npm run build

# Visual verification
npm run dev
# Navigate to Dashboard - verify charts render in both themes
# Navigate to Highlights - verify TagSelector and StudyStatusBadge render in both themes
# Trigger an error (if possible) to verify ErrorBoundary styling
```
</verification>

<success_criteria>
- DashboardCharts.tsx has 0 hardcoded zinc-* and hex colors
- TagSelector.tsx has 0 hardcoded zinc-* colors
- StudyStatusBadge.tsx has 0 hardcoded zinc-* colors
- ErrorBoundary.tsx has 0 hardcoded zinc-* colors
- HighlightStats.tsx is either deleted (orphaned) or migrated
- All components render correctly in light and dark mode
- No TypeScript errors on build
- COLOR-04 requirement satisfied (all Phase 2 components migrated)
</success_criteria>

<output>
After completion, create `.planning/phases/02-component-migration/02-07-SUMMARY.md`
</output>
