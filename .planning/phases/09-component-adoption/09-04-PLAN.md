---
phase: 09-component-adoption
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - pages/Highlights.tsx
autonomous: true

must_haves:
  truths:
    - "Highlights page uses Button component for all action and filter buttons"
    - "Highlights page uses Input component for search input"
    - "Combobox trigger buttons use Button variant='outline' with role and aria attributes preserved"
    - "Bulk action buttons use appropriate Button variants (ghost, destructive)"
    - "No raw <button> with manual styling remains in Highlights.tsx (except checkbox-related if any)"
  artifacts:
    - path: "pages/Highlights.tsx"
      provides: "Full Button and Input component adoption"
      contains: "import { Button }"
  key_links:
    - from: "pages/Highlights.tsx"
      to: "components/ui/button.tsx"
      via: "import { Button }"
      pattern: "import.*Button.*from.*ui/button"
    - from: "pages/Highlights.tsx"
      to: "components/ui/input.tsx"
      via: "import { Input }"
      pattern: "import.*Input.*from.*ui/input"
---

<objective>
Replace raw HTML button and input elements in Highlights.tsx with standardized shadcn Button and Input components.

Purpose: Highlights.tsx is the most complex migration with ~15 buttons (filters, bulk actions, comboboxes, row actions) and 2 inputs (search + checkbox). Each button has a specific role that maps to a Button variant.
Output: Highlights.tsx fully migrated with all raw styled buttons replaced by Button components.
</objective>

<execution_context>
@C:\Users\lbp80\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\lbp80\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-component-adoption/09-RESEARCH.md
@components/ui/button.tsx
@components/ui/input.tsx
@pages/Highlights.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Highlights.tsx buttons to Button component</name>
  <files>pages/Highlights.tsx</files>
  <action>
  Add import at top:
  ```tsx
  import { Button } from '../components/ui/button';
  ```

  Read the file and categorize every `<button>` element (~13-15 total). Replace each based on its role:

  **1. Combobox/dropdown trigger buttons** (role="combobox", aria-expanded):
  - Replace with: `<Button role="combobox" aria-expanded={...} variant="outline" size="compact" className="w-full justify-between">`
  - CRITICAL: Preserve ALL role and aria-* attributes exactly as-is
  - Keep: className layout props (w-full, justify-between, flex, etc.)
  - Remove: manual visual classes (bg-*, border-*, rounded-*, hover:*, px-*, py-*)
  - There are likely 3 combobox triggers (book filter, tag filter, sort)

  **2. Filter toggle buttons** (active/inactive state):
  - Replace with: `<Button variant="ghost" size="compact">` or `<Button variant="outline" size="compact">`
  - Preserve: onClick, conditional active styling via className
  - Keep: data-active or conditional className for active state
  - Active state override: `className={cn(isActive && "bg-accent text-accent-foreground")}`

  **3. Bulk action buttons** (select all, delete selected, etc.):
  - Replace with appropriate variant:
    - Delete/remove: `<Button variant="destructive" size="compact">`
    - Tag/edit: `<Button variant="outline" size="compact">`
    - Select all: `<Button variant="ghost" size="compact">`
  - Preserve: onClick, disabled

  **4. Clear filter / reset buttons**:
  - Replace with: `<Button variant="ghost" size="sm">`
  - Preserve: onClick

  **5. Row-level action buttons** (edit highlight, delete, etc.):
  - Replace with: `<Button variant="ghost" size="icon">` for icon-only actions
  - Replace with: `<Button variant="ghost" size="compact">` for text actions
  - Preserve: onClick, title, aria-label

  **6. Pagination buttons** (if present):
  - Replace with: `<Button variant="outline" size="compact">`
  - Preserve: onClick, disabled

  For ALL replacements:
  - Remove manual visual classes that Button variants already provide
  - Keep layout classes (flex, gap, w-full, absolute, etc.)
  - Preserve all event handlers and accessibility attributes
  - When in doubt about variant, use "ghost" for low-visual-weight actions

  Pitfall avoidance:
  - Combobox buttons MUST preserve role="combobox" and aria-expanded for accessibility
  - Some buttons may trigger Popover/Command components -- do not break the popover wiring
  - If a button is inside a PopoverTrigger or DialogTrigger, it may need `asChild` on the trigger or the Button itself
  </action>
  <verify>
  1. Run: `grep -n "<button" pages/Highlights.tsx` -- should return 0 matches (or only checkbox-related)
  2. Run: `grep -c "<Button" pages/Highlights.tsx` -- should show ~13-15 Button usages
  3. Run: `grep -n 'role="combobox"' pages/Highlights.tsx` -- should still show combobox roles preserved
  4. Run: `npm run build` -- no TypeScript errors
  </verify>
  <done>All raw styled buttons in Highlights.tsx replaced with Button component. Combobox triggers preserve accessibility attributes. Filter/bulk/action buttons use appropriate variants.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate Highlights.tsx inputs to Input component</name>
  <files>pages/Highlights.tsx</files>
  <action>
  Add import (if not already from Task 1):
  ```tsx
  import { Input } from '../components/ui/input';
  ```

  Replace raw `<input>` elements (~2 total):

  **1. Search input** (type="text" or type="search"):
  - Replace with: `<Input type="text" ...>` (or `<Input type="search" ...>`)
  - Preserve: value, onChange, placeholder, id
  - Remove: manual visual classes (h-*, border-*, bg-*, text-*, rounded-*, ring-*, focus:*, px-*, py-*)
  - Keep: layout classes (w-full, flex-1, etc.)
  - If there's a search icon inside a wrapper, keep the wrapper structure and only replace the `<input>` tag

  **2. Checkbox input** (type="checkbox" for select-all):
  - KEEP RAW: `<input type="checkbox">` -- Input component is for text inputs, not checkboxes
  - This is the same decision as Settings.tsx checkboxes
  - No action needed on this element

  Pitfall avoidance:
  - Search input may be inside a relative wrapper with an absolute-positioned icon. Only replace the `<input>` itself, not the wrapper.
  - If search input uses a custom onKeyDown handler (e.g., Escape to clear), preserve it
  </action>
  <verify>
  1. Run: `grep -n "<input" pages/Highlights.tsx` -- should return only the checkbox input (expected exception)
  2. Run: `grep -n "<Input" pages/Highlights.tsx` -- should show 1 Input usage (search)
  3. Run: `npm run build` -- no TypeScript errors
  </verify>
  <done>Search input in Highlights.tsx uses Input component. Checkbox input kept raw (not a text input). Zero raw text inputs remain.</done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `grep -n "<button" pages/Highlights.tsx` returns 0 matches
2. `grep -n "<input" pages/Highlights.tsx` returns only checkbox input
3. `grep -n "import.*Button" pages/Highlights.tsx` shows import
4. `grep -n "import.*Input" pages/Highlights.tsx` shows import
5. All combobox roles and aria attributes preserved
6. `npm run build` succeeds
</verification>

<success_criteria>
- Highlights.tsx: All ~15 buttons replaced with Button variants, 0 raw styled buttons remain
- Highlights.tsx: Search input replaced with Input, checkbox kept raw
- Combobox accessibility: role="combobox" and aria-expanded preserved on all trigger buttons
- Popover/Command wiring: All dropdown triggers still open their respective popovers
- Build succeeds with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/09-component-adoption/09-04-SUMMARY.md`
</output>
