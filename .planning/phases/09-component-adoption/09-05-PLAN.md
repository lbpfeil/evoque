---
phase: 09-component-adoption
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - components/TagManagerSidebar.tsx
  - components/TagSelector.tsx
  - components/BookContextModal.tsx
  - components/HighlightEditModal.tsx
  - components/HighlightTableRow.tsx
  - components/DeckTable.tsx
  - components/patterns/DataTable.tsx
autonomous: true

must_haves:
  truths:
    - "TagManagerSidebar has zero raw <button> elements (all use Button component)"
    - "TagSelector has zero raw <button> elements (all use Button component)"
    - "BookContextModal action button uses Button component"
    - "HighlightEditModal action button uses Button component"
    - "HighlightTableRow 'add note' button evaluated and replaced or documented"
    - "DeckTable.tsx has 1 raw button (table row) that is intentionally kept raw (documented deviation)"
    - "DataTable.tsx is deleted (orphaned component with 0 imports)"
    - "No file in the codebase imports DataTable"
  artifacts:
    - path: "components/TagManagerSidebar.tsx"
      provides: "Full Button adoption (eliminates mixed raw/component pattern)"
      contains: "import { Button }"
    - path: "components/TagSelector.tsx"
      provides: "Full Button adoption (eliminates mixed raw/component pattern)"
      contains: "import { Button }"
    - path: "components/BookContextModal.tsx"
      provides: "Button component for modal actions"
      contains: "import { Button }"
    - path: "components/HighlightEditModal.tsx"
      provides: "Button component for modal actions"
      contains: "import { Button }"
  key_links:
    - from: "components/BookContextModal.tsx"
      to: "components/ui/button.tsx"
      via: "import { Button }"
      pattern: "import.*Button.*from.*ui/button"
    - from: "components/HighlightEditModal.tsx"
      to: "components/ui/button.tsx"
      via: "import { Button }"
      pattern: "import.*Button.*from.*ui/button"
    - from: "pages/*"
      to: "ROADMAP success criteria #1-4"
      via: "Phase-wide grep audit in Task 3"
      pattern: "grep -rn '<button' pages/ components/"
---

<objective>
Complete component-level Button adoption and remove the orphaned DataTable pattern.

Purpose: TagManagerSidebar and TagSelector already import Button but still have raw buttons. BookContextModal, HighlightEditModal, and HighlightTableRow each have 1 raw button. DataTable has 0 imports and should be removed per YAGNI.
Output: All component raw buttons replaced (except documented exceptions), DataTable deleted.
</objective>

<execution_context>
@C:\Users\lbp80\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\lbp80\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/09-component-adoption/09-RESEARCH.md
@components/ui/button.tsx
@components/TagManagerSidebar.tsx
@components/TagSelector.tsx
@components/BookContextModal.tsx
@components/HighlightEditModal.tsx
@components/HighlightTableRow.tsx
@components/patterns/DataTable.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Complete Button adoption in TagManagerSidebar and TagSelector</name>
  <files>components/TagManagerSidebar.tsx, components/TagSelector.tsx</files>
  <action>
  Both files ALREADY import Button component but still have raw `<button>` elements. Replace the remaining raw buttons:

  **TagManagerSidebar.tsx** (3 raw buttons remaining):
  - Already has: `import { Button } from './ui/button';`
  - Find all remaining `<button>` elements (3 total per research)
  - For each:
    - Inline action buttons (edit, delete icons): `<Button size="icon" variant="ghost">`
    - Add tag button: `<Button variant="outline" size="compact">` or `<Button size="compact">`
    - Other actions: Choose variant based on visual weight
  - Remove manual visual classes, keep layout classes
  - Preserve all onClick handlers and accessibility attributes

  **TagSelector.tsx** (4 raw buttons remaining):
  - Already has: `import { Button } from './ui/button';`
  - Find all remaining `<button>` elements (4 total per research)
  - For each:
    - Tag selection/toggle buttons: `<Button variant="ghost" size="compact">`
    - Add tag button: `<Button size="compact">`
    - Popover/combobox triggers: `<Button variant="outline" size="compact">` with role/aria preserved
  - Remove manual visual classes, keep layout classes
  - Preserve all onClick handlers and accessibility attributes

  For both files:
  - They already import Button, so no new import needed
  - Read each file carefully to understand context before replacing
  - Some raw buttons may be intentional (inside Popover/Command patterns) -- evaluate carefully
  - If a raw `<button>` is inside a PopoverTrigger asChild, it should become `<Button>` since PopoverTrigger wraps it
  </action>
  <verify>
  1. Run: `grep -n "<button" components/TagManagerSidebar.tsx` -- should return 0 matches
  2. Run: `grep -n "<button" components/TagSelector.tsx` -- should return 0 matches
  3. Run: `grep -c "<Button" components/TagManagerSidebar.tsx` -- should show total Button count
  4. Run: `grep -c "<Button" components/TagSelector.tsx` -- should show total Button count
  5. Run: `npm run build` -- no TypeScript errors
  </verify>
  <done>TagManagerSidebar and TagSelector have zero raw button elements. All buttons use Button component with appropriate variants.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate modal/row component buttons and remove DataTable</name>
  <files>components/BookContextModal.tsx, components/HighlightEditModal.tsx, components/HighlightTableRow.tsx, components/patterns/DataTable.tsx</files>
  <action>
  **BookContextModal.tsx** (1 button):
  1. Add import: `import { Button } from './ui/button';`
  2. Find the raw `<button>` element (likely a save/submit or close action)
  3. Replace with appropriate Button variant:
     - Primary action (save, submit): `<Button>` (default variant)
     - Secondary (cancel): `<Button variant="outline">`
     - Close: `<Button variant="ghost" size="icon">`
  4. Preserve onClick, disabled, type attributes
  5. Remove manual visual classes

  **HighlightEditModal.tsx** (1 button):
  1. Add import: `import { Button } from './ui/button';`
  2. Find the raw `<button>` element (likely a save action)
  3. Replace with appropriate Button variant (same rules as above)
  4. Preserve onClick, disabled, type attributes
  5. Remove manual visual classes

  **HighlightTableRow.tsx** (1 button, 1 checkbox input):
  1. Read the file and evaluate the "add note" button:
     - If it's a small text or icon button in a table row: Replace with `<Button variant="ghost" size="sm">` or `<Button variant="ghost" size="icon">`
     - If it's deeply styled as part of the table row grid: Consider keeping raw
  2. Add import if replacing: `import { Button } from './ui/button';`
  3. The checkbox input: KEEP RAW -- it has custom SVG checkmark with inline CSS for light/dark mode
     - Do not attempt to replace with Checkbox component (research recommends keeping raw)
  4. Add comment on checkbox if not present:
     ```tsx
     {/* Custom checkbox -- kept raw for SVG checkmark styling */}
     ```

  **DeckTable.tsx** (1 button -- KEEP RAW, document):
  1. Read `components/DeckTable.tsx` and locate the raw `<button>` element (deck row)
  2. This button is a table row styled as a full-width grid element -- Button component styling conflicts with table row appearance
  3. Add a comment above the raw button if not present:
     ```tsx
     {/* Deck row button -- kept raw intentionally (Button styling conflicts with table row grid appearance) */}
     ```
  4. Verify with: `grep -n "<button" components/DeckTable.tsx` -- should return exactly 1 match (the row button)

  **DataTable.tsx** (REMOVE):
  1. Delete the file: `components/patterns/DataTable.tsx`
  2. Verify no imports exist: `grep -rn "DataTable" --include="*.tsx" --include="*.ts"` (should find 0 in source files, only in .planning docs)
  3. Check if `components/patterns/` directory is now empty -- if so, delete the directory too
  4. Rationale: 0 imports after 3+ weeks, incompatible with existing tables (DeckTable uses different structure, HighlightTableRow uses semantic `<tr>`), conditional button/div rendering at line 54 conflicts with Button adoption. YAGNI -- rebuild when needed.
  </action>
  <verify>
  1. Run: `grep -n "<button" components/BookContextModal.tsx` -- should return 0 matches
  2. Run: `grep -n "<button" components/HighlightEditModal.tsx` -- should return 0 matches
  3. Run: `grep -n "<button" components/HighlightTableRow.tsx` -- should return 0 or 1 (if kept raw with comment)
  4. Run: `grep -n "<button" components/DeckTable.tsx` -- should return exactly 1 match (intentional raw deck row button with comment)
  5. Verify DataTable.tsx is deleted: `ls components/patterns/DataTable.tsx` should fail / not exist
  6. Run: `grep -rn "from.*DataTable\|from.*patterns/DataTable" --include="*.tsx" --include="*.ts" pages/ components/ services/ lib/` -- should return 0 matches
  7. Run: `npm run build` -- no TypeScript errors
  </verify>
  <done>BookContextModal, HighlightEditModal buttons replaced with Button component. HighlightTableRow evaluated (replaced or documented). DeckTable.tsx deck row button documented as intentional deviation. DataTable.tsx deleted (0 imports, orphaned infrastructure). Build succeeds.</done>
</task>

<task type="auto">
  <name>Task 3: Final phase-wide audit of raw buttons and inputs</name>
  <files>pages/*.tsx, components/*.tsx</files>
  <action>
  Run a comprehensive audit across ALL pages and components to verify Phase 9 success criteria are met.

  **Step 1: Audit all pages for raw buttons:**
  ```bash
  grep -rn "<button" pages/
  ```
  Expected results:
  - Login.tsx: 0 matches
  - Settings.tsx: 0 matches
  - Highlights.tsx: 0 matches
  - Dashboard.tsx: 0 matches
  - Study.tsx: 0 or 1 (if card-button kept raw with comment)
  - StudySession.tsx: exactly 4 matches (SM-2 rating buttons -- documented deviation)

  **Step 2: Audit all pages for raw inputs:**
  ```bash
  grep -rn "<input" pages/
  ```
  Expected results:
  - Login.tsx: 0 matches
  - Settings.tsx: only hidden file inputs and checkboxes (expected exceptions)
  - Highlights.tsx: only checkbox inputs (expected exception)
  - Dashboard.tsx: 0 matches
  - Study.tsx: 0 matches
  - StudySession.tsx: 0 matches

  **Step 3: Audit components for remaining raw buttons:**
  ```bash
  grep -rn "<button" components/ --include="*.tsx" | grep -v "ui/" | grep -v "patterns/"
  ```
  Expected: Only documented exceptions (DeckTable deck row, HighlightTableRow if kept raw)

  **Step 4: Verify all documented exceptions have comments:**
  For each raw `<button>` found in Steps 1-3, verify it has a comment explaining why it stays raw.

  **Step 5: Produce audit summary:**
  Log a summary confirming:
  - Success criterion #1: All pages use `<Button>` instead of raw `<button>` (with documented exceptions)
  - Success criterion #2: All pages use `<Input>` instead of raw `<input>` where applicable
  - Success criterion #3: DataTable is removed
  - Success criterion #4: No raw `<button>` with manual styling remains in any page file (except documented deviations)

  If any unexpected raw buttons/inputs are found, report them as issues to fix BEFORE marking this task complete.
  </action>
  <verify>
  1. Run: `grep -rn "<button" pages/` -- only StudySession rating buttons (4) and optionally Study.tsx card-button (1 with comment)
  2. Run: `grep -rn "<button" components/ --include="*.tsx"` -- exclude ui/ directory; only DeckTable (1 with comment), HighlightTableRow (0 or 1 with comment)
  3. Run: `grep -rn "<input" pages/` -- only hidden file inputs and checkboxes in Settings.tsx and Highlights.tsx
  4. Every raw button/input found has an adjacent comment explaining the intentional deviation
  5. `npm run build` succeeds with no TypeScript errors
  </verify>
  <done>Phase-wide audit confirms all 4 ROADMAP success criteria are met. Every raw button/input across pages/ and components/ is either replaced with Button/Input component or documented as an intentional exception with comment.</done>
</task>

</tasks>

<verification>
After all three tasks complete:
1. `grep -rn "<button" components/TagManagerSidebar.tsx components/TagSelector.tsx components/BookContextModal.tsx components/HighlightEditModal.tsx` returns 0 matches
2. `grep -n "<button" components/DeckTable.tsx` returns exactly 1 match (documented deviation)
3. DataTable.tsx does not exist
4. No file imports DataTable
5. `npm run build` succeeds
6. HighlightTableRow checkbox has comment explaining why it stays raw
7. Phase-wide audit (Task 3) confirms all pages/ and components/ meet success criteria #1-4 from ROADMAP
</verification>

<success_criteria>
- TagManagerSidebar: 0 raw buttons (was 3), all use Button component
- TagSelector: 0 raw buttons (was 4), all use Button component
- BookContextModal: 0 raw buttons, uses Button component
- HighlightEditModal: 0 raw buttons, uses Button component
- HighlightTableRow: Evaluated -- button replaced or documented, checkbox stays raw
- DeckTable.tsx: 1 raw button documented as intentional deviation (table row styling conflict)
- DataTable.tsx: DELETED (components/patterns/ directory cleaned up)
- Build succeeds with no errors
- No orphaned DataTable imports anywhere in codebase
- Phase-wide audit passes: all ROADMAP success criteria #1-4 verified across entire codebase
</success_criteria>

<output>
After completion, create `.planning/phases/09-component-adoption/09-05-SUMMARY.md`
</output>
