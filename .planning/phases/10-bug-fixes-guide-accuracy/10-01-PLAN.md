---
phase: 10-bug-fixes-guide-accuracy
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/DashboardCharts.tsx
  - components/HighlightEditModal.tsx
  - components/HighlightHistoryModal.tsx
autonomous: true

must_haves:
  truths:
    - "Chart colors render correctly in both light and dark mode"
    - "No hsl() wrapper around CSS custom properties containing oklch values"
    - "Recharts inline styles use var(--token) directly"
  artifacts:
    - path: "components/DashboardCharts.tsx"
      provides: "Dashboard chart colors fixed"
      contains: "var(--primary)"
    - path: "components/HighlightEditModal.tsx"
      provides: "HighlightEditModal chart colors fixed"
      contains: "var(--primary)"
    - path: "components/HighlightHistoryModal.tsx"
      provides: "HighlightHistoryModal chart colors fixed"
      contains: "var(--primary)"
  key_links:
    - from: "Recharts inline styles"
      to: "CSS custom properties"
      via: "var() without hsl() wrapper"
      pattern: "var\\(--(?:primary|foreground|border|muted|popover)"
---

<objective>
Fix hsl() wrapping of oklch() CSS custom properties in chart components

Purpose: Recharts requires inline style colors (cannot use Tailwind classes). The code currently uses `hsl(var(--primary))` but CSS custom properties contain oklch values, not hsl values. This causes functional color rendering bugs.

Output: 3 chart components with corrected color syntax using `var(--X)` directly instead of `hsl(var(--X))`.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@components/DashboardCharts.tsx
@components/HighlightEditModal.tsx
@components/HighlightHistoryModal.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix hsl() wrapping in DashboardCharts.tsx</name>
  <files>components/DashboardCharts.tsx</files>
  <action>
Replace all `hsl(var(--X))` patterns with `var(--X)` in Recharts inline styles.

Current patterns to fix (approximately lines 22-45):
- `hsl(var(--foreground))` → `var(--foreground)`
- `hsl(var(--border))` → `var(--border)`
- `hsl(var(--muted-foreground))` → `var(--muted-foreground)`
- `hsl(var(--popover))` → `var(--popover)`
- `hsl(var(--popover-foreground))` → `var(--popover-foreground)`
- `hsl(var(--primary))` → `var(--primary)`
- `hsl(var(--muted))` → `var(--muted)`

These appear in:
- linearGradient stopColor
- CartesianGrid stroke
- XAxis/YAxis tick fill
- Tooltip contentStyle, itemStyle, cursor
- Area/Bar stroke/fill
  </action>
  <verify>
Run: `grep -c "hsl(var" components/DashboardCharts.tsx`
Expected: 0 matches

Run: `grep -c "var(--" components/DashboardCharts.tsx`
Expected: 14+ matches (all color references now use var() directly)
  </verify>
  <done>DashboardCharts.tsx has 0 hsl() wrappers and all chart colors use var(--token) directly</done>
</task>

<task type="auto">
  <name>Task 2: Fix hsl() wrapping in HighlightEditModal.tsx</name>
  <files>components/HighlightEditModal.tsx</files>
  <action>
Replace all `hsl(var(--X))` patterns with `var(--X)` in Recharts Tooltip and Line inline styles.

Current patterns to fix (approximately lines 182-195):
- Tooltip contentStyle: `hsl(var(--card))`, `hsl(var(--border))`, `hsl(var(--card-foreground))`
- Tooltip itemStyle: `hsl(var(--primary))`
- Line stroke: `hsl(var(--primary))`
- Line dot fill: `hsl(var(--primary))`

Replace each with the corresponding `var(--X)` pattern.
  </action>
  <verify>
Run: `grep -c "hsl(var" components/HighlightEditModal.tsx`
Expected: 0 matches

Run: `grep -c "var(--" components/HighlightEditModal.tsx`
Expected: 6+ matches
  </verify>
  <done>HighlightEditModal.tsx has 0 hsl() wrappers and all chart colors use var(--token) directly</done>
</task>

<task type="auto">
  <name>Task 3: Fix hsl() wrapping in HighlightHistoryModal.tsx</name>
  <files>components/HighlightHistoryModal.tsx</files>
  <action>
Replace all `hsl(var(--X))` patterns with `var(--X)` in Recharts Tooltip and Line inline styles.

Current patterns to fix (approximately lines 84-97):
- Tooltip contentStyle: `hsl(var(--card))`, `hsl(var(--border))`, `hsl(var(--card-foreground))`
- Tooltip itemStyle: `hsl(var(--primary))`
- Line stroke: `hsl(var(--primary))`
- Line dot fill: `hsl(var(--primary))`

Replace each with the corresponding `var(--X)` pattern.
  </action>
  <verify>
Run: `grep -c "hsl(var" components/HighlightHistoryModal.tsx`
Expected: 0 matches

Run: `grep -c "var(--" components/HighlightHistoryModal.tsx`
Expected: 6+ matches
  </verify>
  <done>HighlightHistoryModal.tsx has 0 hsl() wrappers and all chart colors use var(--token) directly</done>
</task>

</tasks>

<verification>
1. Run `grep -r "hsl(var" components/` — expect 0 matches across all chart files
2. Run `npm run build` — expect no TypeScript or build errors
3. Manual: Open Dashboard page, verify charts render with correct colors in both light and dark mode
4. Manual: Open a highlight with learning stats, verify chart renders correctly
</verification>

<success_criteria>
- [ ] 0 instances of `hsl(var(--...))` in DashboardCharts.tsx
- [ ] 0 instances of `hsl(var(--...))` in HighlightEditModal.tsx
- [ ] 0 instances of `hsl(var(--...))` in HighlightHistoryModal.tsx
- [ ] All chart colors use `var(--token)` directly
- [ ] Build passes with no errors
- [ ] Charts render correctly in both themes
</success_criteria>

<output>
After completion, create `.planning/phases/10-bug-fixes-guide-accuracy/10-01-SUMMARY.md`
</output>
