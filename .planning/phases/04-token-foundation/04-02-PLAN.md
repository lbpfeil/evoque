---
phase: 04-token-foundation
plan: 02
type: execute
wave: 2
depends_on: [04-01]
files_modified: [index.css, tailwind.config.js, .planning/phases/04-token-foundation/RAW_COLOR_MAP.md]
autonomous: true

must_haves:
  truths:
    - "Every raw color class (text-zinc-*, bg-gray-*, text-amber-*, bg-blue-*, bg-green-*) in the codebase is identified with file location and line"
    - "Each raw color has a documented semantic replacement (text-muted-foreground, bg-accent, etc.) or a new semantic token if no existing one fits"
    - "Any new semantic color tokens needed for status indicators (new/learning/review) are defined in index.css and mapped in tailwind.config.js"
    - "The build still succeeds after token additions"
  artifacts:
    - path: ".planning/phases/04-token-foundation/RAW_COLOR_MAP.md"
      provides: "Complete mapping of raw color classes to semantic replacements"
      contains: "file, line, raw class, semantic replacement"
    - path: "index.css"
      provides: "Any new semantic color CSS custom properties (status colors)"
      contains: "--status-new, --status-learning, --status-review (if needed)"
    - path: "tailwind.config.js"
      provides: "Any new semantic color mappings in theme.extend.colors"
  key_links:
    - from: "RAW_COLOR_MAP.md"
      to: "Phase 5/6 migration"
      via: "Reference document for component/page migration"
      pattern: "N/A - documentation artifact"
---

<objective>
Audit all raw color classes across the codebase, create a complete mapping document, and define any missing semantic color tokens needed for the migration. This covers requirement TOKENS-08: ban raw color classes (text-zinc-*, bg-gray-*) and force semantic usage (text-foreground, text-muted-foreground, etc.).

Purpose: Phase 5/6 needs a definitive reference to know exactly what to replace and with what. This plan produces that reference and ensures all necessary semantic tokens exist before migration begins.
Output: RAW_COLOR_MAP.md mapping file + any new semantic CSS variables and Tailwind config entries needed.
</objective>

<execution_context>
@C:\Users\lbp80\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\lbp80\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-token-foundation/04-RESEARCH.md
@index.css
@tailwind.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Audit all raw color classes and create mapping document</name>
  <files>.planning/phases/04-token-foundation/RAW_COLOR_MAP.md</files>
  <action>
Search the entire codebase (pages/*.tsx, components/*.tsx, components/ui/*.tsx) for raw Tailwind color classes. These are classes that use explicit color names instead of semantic tokens.

**Patterns to search for:**
- `text-zinc-*`, `text-gray-*`, `text-stone-*`, `text-neutral-*`, `text-slate-*`
- `bg-zinc-*`, `bg-gray-*`, `bg-stone-*`, `bg-neutral-*`, `bg-slate-*`
- `bg-blue-*`, `bg-amber-*`, `bg-green-*`, `bg-red-*`, `bg-orange-*`, `bg-yellow-*`
- `text-blue-*`, `text-amber-*`, `text-green-*`, `text-red-*`, `text-orange-*`, `text-yellow-*`
- `border-zinc-*`, `border-gray-*`, `border-stone-*`
- `ring-zinc-*`, `ring-gray-*`
- `divide-zinc-*`, `divide-gray-*`
- Any other raw color patterns (e.g., `from-*-500`, `to-*-500` for gradients)

**Exclude:** Files in node_modules, .planning, lbp_context, lbp_diretrizes, lbp_implementation directories.
**Exclude:** Classes that are already semantic (bg-background, text-foreground, bg-primary, text-muted-foreground, bg-accent, text-destructive, bg-card, border-border, bg-popover, bg-muted, bg-secondary, etc.).
**Exclude:** shadcn/ui base components in components/ui/*.tsx IF the raw color is part of shadcn's default implementation (these will be handled in Phase 5 component standardization). Flag them but mark as "Phase 5".

For each raw color class found, determine the correct semantic replacement:

**Mapping rules:**
- `text-zinc-500`, `text-gray-500`, `text-stone-500` (medium gray text) -> `text-muted-foreground`
- `text-zinc-700`, `text-gray-700` (darker gray text) -> `text-foreground`
- `text-zinc-400`, `text-gray-400` (lighter gray text) -> `text-muted-foreground` (or `text-muted-foreground/70` if lighter)
- `bg-zinc-50`, `bg-gray-50` (very light backgrounds) -> `bg-muted` or `bg-secondary`
- `bg-zinc-100`, `bg-gray-100` -> `bg-muted`
- `bg-zinc-200`, `bg-gray-200` -> `bg-accent`
- `border-zinc-200`, `border-gray-200` -> `border-border`
- `bg-blue-500` (study status: New) -> `bg-status-new` (new semantic token)
- `bg-amber-500` (study status: Learning) -> `bg-status-learning` (new semantic token)
- `bg-green-500` (study status: Review) -> `bg-status-review` (new semantic token)
- `text-white` on colored backgrounds -> `text-status-foreground` (new semantic token) or existing semantic foreground

**Output format (RAW_COLOR_MAP.md):**

```markdown
# Raw Color Audit - Phase 4 Token Foundation

## Summary
- Total raw color occurrences: [N]
- Files affected: [N]
- New semantic tokens needed: [list]

## New Tokens Required

| Token | Light Value | Dark Value | Used For |
|-------|-------------|------------|----------|
| --status-new | oklch(...) | oklch(...) | Study card "New" badge |
| --status-learning | oklch(...) | oklch(...) | Study card "Learning" badge |
| --status-review | oklch(...) | oklch(...) | Study card "Review/Due" badge |
| --status-foreground | oklch(...) | oklch(...) | Text on status badges |

## Migration Map

### Pages

| File | Line | Raw Class | Semantic Replacement | Context |
|------|------|-----------|---------------------|---------|
| pages/Dashboard.tsx | 42 | text-zinc-500 | text-muted-foreground | subtitle text |
| ... | ... | ... | ... | ... |

### Components (non-UI)

| File | Line | Raw Class | Semantic Replacement | Context |
|------|------|-----------|---------------------|---------|
| ... | ... | ... | ... | ... |

### shadcn/ui Components (Phase 5)

| File | Line | Raw Class | Semantic Replacement | Notes |
|------|------|-----------|---------------------|-------|
| ... | ... | ... | ... | Phase 5 scope |
```

Be thorough. The research found 51 raw color occurrences across 12 files. Every single one must be documented.
  </action>
  <verify>
1. Grep the codebase for raw color patterns and confirm the count in RAW_COLOR_MAP.md matches
2. Every entry in the map has a concrete semantic replacement (no "TBD" or "TODO")
3. Status color tokens are identified if StudySession/Study pages use raw blue/amber/green
  </verify>
  <done>RAW_COLOR_MAP.md exists with every raw color occurrence documented, each with a specific semantic replacement</done>
</task>

<task type="auto">
  <name>Task 2: Define new semantic color tokens and verify complete token system</name>
  <files>index.css, tailwind.config.js</files>
  <action>
Based on the audit from Task 1, add any NEW semantic color tokens to index.css and tailwind.config.js that don't already exist in the semantic color system.

**Expected new tokens (verify against audit):**

In index.css `:root` block, add after the existing color variables (before `--radius`):
```css
/* Status colors - study card states */
--status-new: oklch(0.55 0.20 250);         /* Blue - matches current bg-blue-500 */
--status-learning: oklch(0.70 0.15 85);     /* Amber - matches current bg-amber-500 */
--status-review: oklch(0.60 0.18 145);      /* Green - matches current bg-green-500 */
--status-foreground: oklch(0.99 0.01 90);   /* White text on status badges */
```

In index.css `.dark` block, add matching dark-mode values:
```css
/* Status colors - study card states (dark mode) */
--status-new: oklch(0.65 0.18 250);
--status-learning: oklch(0.78 0.13 85);
--status-review: oklch(0.70 0.16 145);
--status-foreground: oklch(0.99 0.01 90);
```

In tailwind.config.js `theme.extend.colors`, add:
```javascript
status: {
  new: 'var(--status-new)',
  learning: 'var(--status-learning)',
  review: 'var(--status-review)',
  foreground: 'var(--status-foreground)',
},
```

**IMPORTANT:** The exact OKLCH values should match the visual appearance of the current raw colors (bg-blue-500, bg-amber-500, bg-green-500). Use the closest OKLCH approximation. The values above are approximations -- verify they look similar by comparing hex equivalents.

Only add tokens that the audit actually confirmed are needed. If the audit shows no raw status colors, skip them. If the audit reveals OTHER categories of raw colors needing new tokens, add those instead.

After adding tokens, run `npm run build` to verify the entire token system (Plan 01 + Plan 02) works together.
  </action>
  <verify>
1. `npm run build` succeeds with all token additions from both Plan 01 and Plan 02
2. `npm run dev` starts without errors
3. Any new color tokens in index.css exist in both `:root` and `.dark` blocks
4. Any new color tokens are mapped in tailwind.config.js
5. The existing app looks identical (no visual regressions -- all changes are additive)
  </verify>
  <done>All semantic color tokens exist for every raw color usage found in the audit. Build succeeds. RAW_COLOR_MAP.md provides Phase 5/6 with a complete migration reference.</done>
</task>

</tasks>

<verification>
1. RAW_COLOR_MAP.md contains every raw color occurrence in the codebase with file, line, raw class, and semantic replacement
2. All new semantic tokens exist in index.css (both :root and .dark)
3. All new semantic tokens are mapped in tailwind.config.js
4. `npm run build` succeeds
5. `npm run dev` shows no visual regressions
6. TOKENS-08 requirement satisfied: raw colors identified and semantic replacements defined
</verification>

<success_criteria>
- RAW_COLOR_MAP.md is a complete reference document for Phase 5/6 migration
- Every raw color class has a defined semantic replacement
- New semantic tokens (status colors or others) are defined in CSS and Tailwind config
- Build and dev server work without errors
- TOKENS-08 requirement fully satisfied
</success_criteria>

<output>
After completion, create `.planning/phases/04-token-foundation/04-02-SUMMARY.md`
</output>
