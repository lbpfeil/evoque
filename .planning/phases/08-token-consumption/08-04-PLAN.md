---
phase: 08-token-consumption
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - components/TagSelector.tsx
  - components/TagManagerSidebar.tsx
  - components/DeckTable.tsx
  - components/StudyStatusBadge.tsx
  - components/HighlightTableRow.tsx
  - components/HighlightEditModal.tsx
autonomous: true

must_haves:
  truths:
    - "TagSelector uses semantic spacing and typography tokens"
    - "TagManagerSidebar uses semantic spacing and typography tokens"
    - "DeckTable uses semantic tokens for spacing, typography, and status colors"
    - "StudyStatusBadge uses semantic status color tokens where appropriate"
    - "HighlightTableRow uses semantic spacing and typography tokens"
    - "HighlightEditModal uses semantic spacing and typography tokens"
    - "All 6 components build without errors"
  artifacts:
    - path: "components/TagSelector.tsx"
      provides: "Tag selector with semantic tokens"
      contains: "p-md|gap-sm|text-body|text-caption"
    - path: "components/DeckTable.tsx"
      provides: "Deck table with semantic tokens and status colors"
      contains: "text-body|text-caption|text-status-new|text-status-learning|text-status-review"
    - path: "components/StudyStatusBadge.tsx"
      provides: "Status badge with semantic color tokens where applicable"
  key_links:
    - from: "tailwind.config.js colors.status"
      to: "components/DeckTable.tsx"
      via: "status color tokens for deck stats"
      pattern: "text-status-(new|learning|review)"
    - from: "tailwind.config.js colors.tag"
      to: "components/TagSelector.tsx"
      via: "tag color tokens"
      pattern: "bg-tag-(global|book)"
---

<objective>
Migrate 6 high-interaction components (tag management, deck table, status badge, highlight row/edit) from raw Tailwind values to semantic design tokens.

Purpose: These components have the most raw values among non-UI components and handle color-sensitive features (tags, status badges). They require careful color token mapping.
Output: All 6 components use semantic tokens for spacing, typography, and color where semantic equivalents exist.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-token-consumption/08-RESEARCH.md
@tailwind.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate TagSelector and TagManagerSidebar to semantic tokens</name>
  <files>components/TagSelector.tsx, components/TagManagerSidebar.tsx</files>
  <action>
Migrate both tag-related components from raw values to semantic tokens.

**Spacing:** Standard mapping for both files (~28 spacing values each).
- 1->xxs, 2->xs, 3->sm, 4->md, 6->lg, 8->xl
- Sub-4px (0.5): KEEP raw

**Typography:** (~15 each)
- `text-xs` -> `text-caption`
- `text-sm` -> `text-body`
- `text-base` in TagManagerSidebar sheet title (~line 262) -> `text-heading`

**Colors (TAG-SPECIFIC -- requires careful handling):**

For TagSelector.tsx (~10 color values):
- `bg-blue-500 dark:bg-blue-600 text-white` (global tag badge fill) -> `bg-tag-global text-status-foreground`
- `bg-amber-500 dark:bg-amber-600 text-white` (book tag badge fill) -> `bg-tag-book text-status-foreground`
- `text-blue-600` (global tag text) -> Try `text-tag-global`. If Tailwind resolves it, use it. The color is defined under `colors.tag.global` so `text-tag-global` should work.
- `text-amber-600` (book tag text) -> Try `text-tag-book`. Same logic.
- `text-amber-500` (book tag icon) -> Try `text-tag-book`. Close enough.
- `hover:bg-blue-50` (global tag hover) -> No semantic token for tinted hover. KEEP raw and add comment: `{/* tinted hover: no semantic token */}`
- `hover:bg-amber-50` (book tag hover) -> Same: KEEP raw with comment.
- `bg-amber-50 text-amber-700` (book tag light badge) -> No tinted semantic token. KEEP raw with comment.

For TagManagerSidebar.tsx (~5 color values):
- Same tag color patterns as TagSelector. Apply same logic.
- `text-green-600 dark:text-green-400` (success) -> `text-success`
- `bg-blue-600` if present -> `bg-primary`
  </action>
  <verify>
Run grep checks on both files:
- `grep -nP "\b(p|px|py|pt|pb|pl|pr|m|mx|my|mt|mb|ml|mr|gap|space-[xy])-[0-9]" components/TagSelector.tsx components/TagManagerSidebar.tsx` -- only sub-4px (0.5) allowed
- `grep -n "text-\(sm\|xs\|base\|lg\)" components/TagSelector.tsx components/TagManagerSidebar.tsx` -- zero matches
- `grep -n "bg-tag-global\|bg-tag-book\|text-tag-" components/TagSelector.tsx` -- should show tag token usage
- `npm run build` succeeds
  </verify>
  <done>TagSelector and TagManagerSidebar use semantic tokens for spacing, typography, and solid tag colors. Tinted hover/background variants documented as exceptions with comments.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate DeckTable, StudyStatusBadge, HighlightTableRow, HighlightEditModal to semantic tokens</name>
  <files>components/DeckTable.tsx, components/StudyStatusBadge.tsx, components/HighlightTableRow.tsx, components/HighlightEditModal.tsx</files>
  <action>
Migrate 4 components from raw values to semantic tokens.

**DeckTable.tsx (~96 lines, ~5 spacing, ~12 typography, ~5 colors):**
- Spacing: Standard mapping
- Typography: `text-xs` -> `text-caption`, `text-sm` -> `text-body`
- Colors: Status stat text colors:
  - `text-blue-600` (new count) -> `text-status-new`
  - `text-amber-600` (learning count) -> `text-status-learning`
  - `text-green-600` (review count) -> `text-status-review`
  - Verify `text-status-*` works (colors are under `colors.status.*`, so `text-status-new` should resolve)

**StudyStatusBadge.tsx (~45 lines, ~2 spacing, ~12 colors):**
- Spacing: Standard mapping
- Colors (CAREFUL -- see Pitfall 5 in RESEARCH.md):
  - Solid status dots (`bg-blue-500`, `bg-amber-500`, `bg-green-500`) -> `bg-status-new`, `bg-status-learning`, `bg-status-review`
  - Tinted badge backgrounds (`bg-green-50`, `bg-blue-50`, `bg-yellow-50`): Try `bg-status-review/10`, `bg-status-new/10`, `bg-status-learning/10`. These use Tailwind's opacity modifier. If oklch + opacity renders differently than the Tailwind palette tint, keep raw and document.
  - Text colors on badges (`text-green-700`, `text-blue-700`, `text-yellow-700`): Try `text-status-review`, `text-status-new`, `text-status-learning`. If contrast is insufficient on tinted bg, keep raw.
  - Border colors (`border-green-200`, `border-blue-200`, `border-yellow-200`): Try `border-status-review/30`, `border-status-new/30`, `border-status-learning/30`. If visual mismatch, keep raw.
  - **Note:** `yellow-*` for "Learning" should map to `status-learning` (amber-based token). The badge inconsistently uses yellow instead of amber -- this is a known pre-existing issue.

**HighlightTableRow.tsx (~127 lines, ~8 spacing, ~5 typography, 0 colors):**
- Spacing: Standard mapping
- Typography: `text-xs` -> `text-caption`, `text-sm` -> `text-body`
- No colors to replace

**HighlightEditModal.tsx (~223 lines, ~8 spacing, ~10 typography, 0 colors):**
- Spacing: Standard mapping
- Typography: `text-xs` -> `text-caption`, `text-sm` -> `text-body`, `text-base` at dialog title -> `text-heading`
- Note: hsl(var(--...)) bug is in this file but is deferred to Phase 10. Do NOT touch JavaScript inline styles -- only Tailwind className strings.
  </action>
  <verify>
Run grep checks on all 4 files:
- `grep -nP "\b(p|px|py|pt|pb|pl|pr|m|mx|my|mt|mb|ml|mr|gap|space-[xy])-[0-9]" components/DeckTable.tsx components/StudyStatusBadge.tsx components/HighlightTableRow.tsx components/HighlightEditModal.tsx` -- only sub-4px (0.5) allowed
- `grep -n "text-\(sm\|xs\|base\|lg\)" components/DeckTable.tsx components/StudyStatusBadge.tsx components/HighlightTableRow.tsx components/HighlightEditModal.tsx` -- zero matches
- `grep -n "text-status-\|bg-status-" components/DeckTable.tsx components/StudyStatusBadge.tsx` -- should show status token usage
- `npm run build` succeeds
  </verify>
  <done>DeckTable uses semantic status text colors. StudyStatusBadge uses semantic status colors for solid fills (tinted variants documented if kept raw). HighlightTableRow and HighlightEditModal use semantic spacing and typography tokens. All 4 build successfully.</done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `npm run build` passes with no new errors
2. Tag components use `bg-tag-global`, `bg-tag-book` for solid fills
3. DeckTable uses `text-status-new/learning/review` for stat text colors
4. StudyStatusBadge uses `bg-status-*` for solid fills
5. All raw spacing and typography replaced across all 6 files
</verification>

<success_criteria>
- 6 components fully migrated to semantic tokens
- Tag solid fills use bg-tag-global/book tokens
- Status colors use bg-status-*/text-status-* tokens
- Tinted hover/background variants documented as exceptions where semantic tokens don't exist
- Build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/08-token-consumption/08-04-SUMMARY.md`
</output>
