---
phase: 01-foundation
plan: 07
type: execute
wave: 1
depends_on: []
files_modified: [components/BottomNav.tsx, App.tsx]
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Main content is not hidden behind sidebar on desktop"
    - "BottomNav uses semantic color tokens in dark mode"
    - "Layout responds smoothly to sidebar expand/collapse"
  artifacts:
    - path: "App.tsx"
      provides: "Dynamic margin based on sidebar state"
      contains: "useSidebarContext"
    - path: "components/BottomNav.tsx"
      provides: "Mobile nav with semantic colors"
      contains: "bg-background"
  key_links:
    - from: "App.tsx"
      to: "SidebarContext"
      via: "useSidebarContext hook"
      pattern: "isExpanded.*ml-"
---

<objective>
Fix sidebar layout overlap and BottomNav dark mode colors

Purpose: User reported "páginas ainda estão aparecendo atrás da barra lateral (conteúdo cortado à esquerda)" and mobile nav showing old gray colors.
Output: Dynamic sidebar margin and semantic color tokens on mobile nav
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-UAT.md (Gap 2 and Gap 3)
@components/SidebarContext.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix sidebar layout overlap in App.tsx</name>
  <files>App.tsx</files>
  <action>
Make main content margin dynamic based on sidebar expansion state.

Current problem: Main content has static `md:ml-14` but sidebar expands to `w-56` on hover, causing 168px overlap.

Solution: Use useSidebarContext to get isExpanded state and apply dynamic margin.

1. In AppLayout component, import and use useSidebarContext:
   - The import already exists (line 8): `import { SidebarProvider, useSidebarContext } from './components/SidebarContext';`
   - Inside AppLayout, get the state: `const { isExpanded } = useSidebarContext();`

2. Update the main element className (around line 40):
   - Current: `md:ml-14`
   - Change to: `${isExpanded ? 'md:ml-56' : 'md:ml-14'}`

The full className should become:
```jsx
className={`flex-1 ${!isStudySession ? `p-4 md:p-8 pb-20 md:pb-8 ${isExpanded ? 'md:ml-56' : 'md:ml-14'}` : ''} overflow-y-auto h-screen transition-all duration-300 ease-in-out`}
```

This ensures:
- Collapsed sidebar (w-14) -> main has ml-14
- Expanded sidebar (w-56) -> main has ml-56
- Smooth transition via existing `transition-all duration-300`
  </action>
  <verify>
- `grep -n "isExpanded.*ml-" App.tsx` returns the dynamic margin line
- `npm run build` completes without errors
  </verify>
  <done>Main content margin responds to sidebar state, no content hidden behind sidebar</done>
</task>

<task type="auto">
  <name>Task 2: Fix BottomNav dark mode colors</name>
  <files>components/BottomNav.tsx</files>
  <action>
Replace hardcoded zinc colors with semantic tokens in BottomNav.tsx.

Current (line 12):
```jsx
className="fixed bottom-0 left-0 right-0 bg-white dark:bg-zinc-900 border-t border-zinc-200 dark:border-zinc-800 flex justify-around items-center h-20 py-2 md:hidden z-50 safe-area-inset-bottom"
```

Replace with semantic tokens:
```jsx
className="fixed bottom-0 left-0 right-0 bg-background border-t border-border flex justify-around items-center h-20 py-2 md:hidden z-50 safe-area-inset-bottom"
```

Changes:
- `bg-white dark:bg-zinc-900` -> `bg-background`
- `border-zinc-200 dark:border-zinc-800` -> `border-border`

Also update the NavLink text colors (lines 17-20):
Current:
```jsx
isActive ? 'text-black dark:text-white' : 'text-zinc-400 dark:text-zinc-500'
```

Replace with:
```jsx
isActive ? 'text-foreground' : 'text-muted-foreground'
```

This ensures BottomNav respects the warm oklch palette defined in index.css.
  </action>
  <verify>
- `grep -n "dark:bg-zinc\|dark:border-zinc" components/BottomNav.tsx` returns no matches
- `npm run build` completes without errors
  </verify>
  <done>BottomNav uses semantic tokens and displays warm colors in dark mode</done>
</task>

</tasks>

<verification>
- Run `npm run build` - should complete with no errors
- Run `npm run dev` and test:
  1. Desktop: Hover over sidebar to expand - main content should shift right, no overlap
  2. Mobile: Switch to dark mode - bottom nav should show warm background, not gray
</verification>

<success_criteria>
1. Desktop sidebar expansion does not overlap main content
2. BottomNav shows warm oklch colors in dark mode
3. Smooth transition when sidebar expands/collapses
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-07-SUMMARY.md`
</output>
