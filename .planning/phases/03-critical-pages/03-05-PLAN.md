---
phase: 03-critical-pages
plan: 05
type: execute
wave: 2
depends_on: [03-04]
files_modified: [pages/StudySession.tsx]
autonomous: false

must_haves:
  truths:
    - "Card content text uses semantic tokens"
    - "font-serif class preserved on lines 529, 538, 578, 584"
    - "Edit sections use bg-muted and border-border"
    - "Book info text uses text-foreground and text-muted-foreground"
  artifacts:
    - path: "pages/StudySession.tsx"
      provides: "Card display with semantic tokens and preserved serif font"
      contains: "font-serif"
  key_links:
    - from: "pages/StudySession.tsx"
      to: "font-serif class"
      via: "CSS class names"
      pattern: "font-serif"
---

<objective>
Migrate StudySession.tsx card display area to semantic tokens while PRESERVING the serif font.

Purpose: The card display is the core reading experience. Serif font is a user-approved design decision that MUST be preserved.
Output: StudySession.tsx with semantic tokens for card content while keeping font-serif on highlight/note text.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-critical-pages/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate book info and tag display to semantic tokens</name>
  <files>pages/StudySession.tsx</files>
  <action>
Replace hardcoded zinc colors in book info section:

1. Book title (line 426):
   - BEFORE: `text-zinc-900 dark:text-zinc-100`
   - AFTER: `text-foreground`

2. Book author (line 427):
   - BEFORE: `text-zinc-400 dark:text-zinc-500`
   - AFTER: `text-muted-foreground`

3. Tag overflow button (lines 463, 506):
   - BEFORE: `bg-zinc-300 dark:bg-zinc-700 text-zinc-700 dark:text-zinc-300 hover:bg-zinc-400 dark:hover:bg-zinc-600`
   - AFTER: `bg-muted text-muted-foreground hover:bg-muted/80`

IMPORTANT: KEEP the tag colors (bg-amber-500/600 for book-specific, bg-blue-500/600 for global) - these are semantically meaningful (lines 452-454, 495-497).
  </action>
  <verify>Run `npm run build` to confirm no TypeScript errors</verify>
  <done>Book info and tag overflow use semantic tokens, tag colors preserved</done>
</task>

<task type="auto">
  <name>Task 2: Migrate edit sections to semantic tokens (PRESERVE font-serif)</name>
  <files>pages/StudySession.tsx</files>
  <action>
Replace hardcoded zinc colors in edit sections. CRITICAL: Preserve font-serif class.

1. Edit highlight container (line 518):
   - BEFORE: `bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800`
   - AFTER: `bg-muted border border-border`

2. Edit highlight label (line 520):
   - BEFORE: `text-zinc-400 dark:text-zinc-500`
   - AFTER: `text-muted-foreground`

3. Edit highlight spinner icon (line 523):
   - BEFORE: `text-zinc-400 dark:text-zinc-500`
   - AFTER: `text-muted-foreground`

4. Edit highlight textarea (line 529) - PRESERVE font-serif:
   - BEFORE: `bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 ... text-zinc-800 dark:text-zinc-200 ... focus:ring-black dark:focus:ring-white focus:border-black dark:focus:border-white ... font-serif`
   - AFTER: `bg-background border border-input ... text-foreground ... focus:ring-ring focus:border-ring ... font-serif`
   CRITICAL: Keep font-serif at the end of the class string.

5. Edit hint text (line 533):
   - BEFORE: `text-zinc-400 dark:text-zinc-500`
   - AFTER: `text-muted-foreground`

6. Highlight blockquote (line 538) - PRESERVE font-serif:
   - BEFORE: `font-serif italic text-zinc-800 dark:text-zinc-200`
   - AFTER: `font-serif italic text-foreground`
   CRITICAL: Keep font-serif at the start of the class string.

7. Edit highlight button (line 544):
   - BEFORE: `text-zinc-400 dark:text-zinc-500 hover:text-black dark:hover:text-white`
   - AFTER: `text-muted-foreground hover:text-foreground`
  </action>
  <verify>
Run `grep -n "font-serif" pages/StudySession.tsx` to confirm font-serif still exists on lines 529, 538
  </verify>
  <done>Edit highlight section uses semantic tokens, font-serif preserved</done>
</task>

<task type="auto">
  <name>Task 3: Migrate answer section to semantic tokens (PRESERVE font-serif)</name>
  <files>pages/StudySession.tsx</files>
  <action>
Replace hardcoded zinc colors in answer/note section. CRITICAL: Preserve font-serif class.

1. Edit note container (line 556):
   - BEFORE: `bg-zinc-50 dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800`
   - AFTER: `bg-muted border border-border`

2. Edit note label (line 558):
   - BEFORE: `text-zinc-400 dark:text-zinc-500`
   - AFTER: `text-muted-foreground`

3. Edit note spinner icon (line 561):
   - BEFORE: `text-zinc-400 dark:text-zinc-500`
   - AFTER: `text-muted-foreground`

4. Edit note textarea (line 567) - no font-serif here (intentional):
   - BEFORE: `bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 ... text-zinc-800 dark:text-zinc-200 ... focus:ring-black dark:focus:ring-white focus:border-black dark:focus:border-white`
   - AFTER: `bg-background border border-input ... text-foreground ... focus:ring-ring focus:border-ring`

5. Edit note hint (line 572):
   - BEFORE: `text-zinc-400 dark:text-zinc-500`
   - AFTER: `text-muted-foreground`

6. Divider lines (lines 577, 579):
   - BEFORE: `bg-zinc-200 dark:bg-zinc-800`
   - AFTER: `bg-border`

7. Divider tilde (line 578) - PRESERVE font-serif:
   - BEFORE: `font-serif italic text-zinc-300 dark:text-zinc-700`
   - AFTER: `font-serif italic text-border`
   CRITICAL: Keep font-serif.

8. Note display (line 584) - PRESERVE font-serif:
   - BEFORE: `font-serif text-zinc-800 dark:text-zinc-200`
   - AFTER: `font-serif text-foreground`
   CRITICAL: Keep font-serif.

9. No note text (line 589):
   - BEFORE: `text-zinc-400 dark:text-zinc-500`
   - AFTER: `text-muted-foreground`

10. "Add a note" link (line 592):
    - BEFORE: `text-zinc-500 dark:text-zinc-500 hover:text-black dark:hover:text-white`
    - AFTER: `text-muted-foreground hover:text-foreground`

11. Edit note button (line 602):
    - BEFORE: `text-zinc-300 dark:text-zinc-700 hover:text-black dark:hover:text-white`
    - AFTER: `text-border hover:text-foreground`
  </action>
  <verify>
Run `grep -n "font-serif" pages/StudySession.tsx` to confirm font-serif exists on lines 529, 538, 578, 584
  </verify>
  <done>Answer section uses semantic tokens, font-serif preserved on all 4 required lines</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>StudySession.tsx card display migrated to semantic tokens with preserved serif font</what-built>
  <how-to-verify>
1. Run `npm run dev`
2. Navigate to http://localhost:3000/#/study and start a session with cards
3. Verify book info:
   - Book title clearly readable
   - Author name slightly dimmed
   - Tags (if any) show blue for global, amber for book-specific
4. Verify highlight text:
   - CRITICAL: Text should be in SERIF font (different from UI text)
   - Text is readable in both light and dark mode
5. Click the edit (pencil) icon on the highlight:
   - Edit container has muted background
   - Textarea has serif font
   - Save hint text is visible
6. Click "Reveal Answer" to see the note section:
   - Decorative divider (~) is visible and in serif
   - Note text (if exists) is in SERIF font
   - "No note attached" or note content is readable
7. Toggle theme and verify:
   - All text adapts correctly
   - Serif font remains on highlight and note text
   - Borders and backgrounds adapt
  </how-to-verify>
  <resume-signal>Type "approved" to continue to 03-06-PLAN.md, or describe issues for revision</resume-signal>
</task>

</tasks>

<verification>
## Automated Checks

```bash
npm run build
grep -n "font-serif" pages/StudySession.tsx
# Should show font-serif on lines ~529, ~538, ~578, ~584
```

## Visual Verification

- [ ] Book title readable in both themes
- [ ] Author text appropriately dimmed
- [ ] Tag colors preserved (blue global, amber book-specific)
- [ ] SERIF font on highlight text
- [ ] SERIF font on note text
- [ ] SERIF font in edit textareas
- [ ] Edit containers have muted background
- [ ] Divider tilde visible
</verification>

<success_criteria>
1. Card content uses text-foreground and text-muted-foreground
2. font-serif class preserved on lines 529, 538, 578, 584
3. Edit sections use bg-muted and border-border
4. Tag colors (blue/amber) preserved
5. User has approved the serif font is still visible on cards
</success_criteria>

<output>
After completion, create `.planning/phases/03-critical-pages/03-05-SUMMARY.md`
</output>
