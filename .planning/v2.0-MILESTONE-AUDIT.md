---
milestone: v2.0
audited: 2026-01-28
status: gaps_found
scores:
  requirements: 20/22
  phases: 4/4
  integration: 4/10
  flows: 2/6
gaps:
  requirements:
    - "TOKENS-02 (Spacing): Tokens defined but never consumed by pages — all 6 pages use raw numeric spacing"
    - "TOKENS-08 (Color rules): Status/tag/success semantic tokens defined but never consumed — pages use raw Tailwind colors"
  integration:
    - "Phase 4 → Phase 6 (spacing tokens → pages): BROKEN — 0 pages use semantic spacing tokens"
    - "Phase 4 → Phase 6 (color tokens → pages): BROKEN — status/tag/success tokens never consumed"
    - "Phase 4 → Phase 6 (motion/z-index/icon tokens): ORPHANED — never consumed anywhere"
    - "Phase 5 → Phase 6 (Button component → pages): BROKEN — 0 pages import Button; all use raw <button>"
    - "Phase 5 → Phase 6 (DataTable → pages): ORPHANED — never imported by any file"
    - "Phase 6 → Phase 7 (guide accuracy): PARTIAL — guide documents aspirational state for spacing/typography/color rules"
  flows:
    - "Token → Page flow: Typography partially connected (text-heading/text-overline used, text-body/text-display orphaned)"
    - "Spacing token flow: Completely broken — defined → mapped → never consumed by pages"
    - "Color token flow: Status/tag/success tokens defined → mapped → never consumed"
    - "Button component flow: Standardized → never adopted by pages"
tech_debt:
  - phase: 04-token-foundation
    items:
      - "text-display token (2rem/32px) defined but never used anywhere"
      - "text-body token consumed only by PageHeader default size (which no page uses)"
      - "All 6 motion tokens (3 durations + 3 easings) never consumed"
      - "All icon size tokens (w-icon-sm/md/lg) never consumed"
      - "All z-index tokens never consumed"
  - phase: 05-component-standardization
    items:
      - "DataTable component is fully orphaned (0 imports)"
      - "Button component only used in TagSelector and TagManagerSidebar, not in any page"
      - "Input component only used in TagManagerSidebar, not in any page"
  - phase: 06-page-migration
    items:
      - "hsl(var(--...)) wrapping oklch values in 3 chart components — functionally broken color rendering"
      - "StudyHeatmap uses raw zinc/gray colors (documented as intentional deviation)"
      - "100+ raw text-sm/text-xs usages across pages instead of text-body/text-caption tokens"
      - "100+ raw numeric spacing values across pages instead of semantic tokens"
      - "7+ raw status/tag colors across pages instead of semantic tokens"
      - "All pages use raw <button> elements instead of <Button> component"
  - phase: 07-design-guide
    items:
      - "Guide documents 3 anti-pattern rules that the codebase violates (no hardcoded spacing, no raw text sizes, no manual button sizing)"
      - "Secondary reference files (lbp_context/) still reference deleted compact-ui-design-guidelines.md"
---

# v2.0 Milestone Audit Report

**Milestone:** v2.0 Design System Overhaul
**Audited:** 2026-01-28
**Status:** GAPS FOUND
**Core Value:** Consistência obsessiva — cada elemento visual idêntico ao equivalente em qualquer página

## Executive Summary

All 4 phases passed their individual verifications. However, cross-phase integration reveals that **Phase 6 (Page Migration) did not consume most of the tokens and components built in Phases 4-5**. The token foundation and component standardization work is correctly wired at the infrastructure level (CSS → Tailwind config → component source), but the final mile — migrating actual page code to use these tokens — was only partially completed.

The design guide (Phase 7) accurately documents the token system and component APIs, but its "rules" section describes an aspirational state that the codebase does not yet achieve.

## Phase Verifications

| Phase | Status | Score | Date |
|-------|--------|-------|------|
| 4. Token Foundation | PASSED | 8/8 requirements | 2026-01-28 |
| 5. Component Standardization | PASSED | 4/4 requirements | 2026-01-28 |
| 6. Page Migration | PASSED | 8/8 requirements | 2026-01-28 |
| 7. Design Guide | PASSED | 2/2 requirements | 2026-01-28 |

All phases passed individually. Gaps emerge only at the integration level.

## Requirements Coverage

| Requirement | Phase | Status | Notes |
|-------------|-------|--------|-------|
| TOKENS-01 Typography | 4 | SATISFIED | 6 sizes defined and partially consumed |
| TOKENS-02 Spacing | 4 | PARTIAL | 8 tokens defined but 0 pages consume them |
| TOKENS-03 Border-radius | 4 | SATISFIED | 3 values verified |
| TOKENS-04 Shadows | 4 | SATISFIED | 3 elevations defined |
| TOKENS-05 Motion | 4 | SATISFIED* | Defined but never consumed (infrastructure only) |
| TOKENS-06 Icon sizes | 4 | SATISFIED* | Defined but never consumed (infrastructure only) |
| TOKENS-07 Z-index | 4 | SATISFIED* | Defined but never consumed (infrastructure only) |
| TOKENS-08 Color rules | 4 | PARTIAL | Raw colors audited, semantic tokens created, but pages never migrated to use them |
| COMP-01 Audit defaults | 5 | SATISFIED | Button h-8 compact, Input h-8, Badge/Card verified |
| COMP-02 PageHeader | 5 | SATISFIED | Created and consumed by 4 pages |
| COMP-03 DataTable | 5 | SATISFIED* | Created but never imported (orphaned) |
| COMP-04 CVA variants | 5 | SATISFIED | Token-aligned variants exist |
| PAGE-01 Dashboard | 6 | SATISFIED | PageHeader + token typography |
| PAGE-02 Highlights | 6 | SATISFIED | PageHeader + token typography |
| PAGE-03 Study | 6 | SATISFIED | PageHeader + token typography |
| PAGE-04 StudySession | 6 | SATISFIED | Serif preserved + token labels |
| PAGE-05 BookDetails | 6 | N/A | Page removed from codebase |
| PAGE-06 Settings | 6 | SATISFIED | PageHeader + token typography |
| PAGE-07 Login | 6 | SATISFIED | Token typography |
| PAGE-08 Modals | 6 | SATISFIED | Consistent header styles |
| DOC-01 Design guide | 7 | SATISFIED | 601-line guide with tokens + components + patterns |
| DOC-02 Replace old guide | 7 | SATISFIED | Old file deleted, CLAUDE.md updated |

**Score: 20/22 fully satisfied, 2 partial**

*Note: Requirements marked SATISFIED* are technically met (tokens exist as specified) but the tokens are infrastructure-only with no consumption.*

## Cross-Phase Integration

| Connection | Status | Details |
|-----------|--------|---------|
| Phase 4 → 5 (tokens → CVA) | **CONNECTED** | Button, Input, Badge, Card use token values |
| Phase 4 → 6 (typography → pages) | **PARTIAL** | text-heading/text-overline used; text-body/text-display orphaned |
| Phase 4 → 6 (spacing → pages) | **BROKEN** | 0 pages use semantic spacing; all use raw numeric |
| Phase 4 → 6 (colors → pages) | **BROKEN** | Status/tag/success tokens never consumed |
| Phase 4 → 6 (motion/z-index/icons) | **ORPHANED** | Never consumed anywhere |
| Phase 5 → 6 (PageHeader → pages) | **CONNECTED** | 4 pages import and use PageHeader |
| Phase 5 → 6 (DataTable → pages) | **ORPHANED** | 0 imports anywhere |
| Phase 5 → 6 (Button → pages) | **BROKEN** | 0 pages use Button; all use raw `<button>` |
| Phase 6 → 7 (code → guide) | **PARTIAL** | Architecture/APIs accurate; rules describe aspirational state |
| Phase 7 (old guide replaced) | **CONNECTED** | Old file deleted, CLAUDE.md updated |

**Score: 4/10 fully connected, 3 partial, 3 broken/orphaned**

## Critical Gaps (Blockers)

### 1. Spacing Tokens Are a Dead Layer

Phase 4 defined 8 semantic spacing tokens (`p-xxs` through `p-3xl`). Phase 5 used them in PageHeader and DataTable. Phase 6 never migrated any page. All 6 pages still use raw Tailwind numeric spacing (`p-4`, `gap-6`, `mb-3`). The design guide prohibits raw spacing but every page violates this rule.

### 2. Status/Tag/Success Color Tokens Never Consumed

Phase 4 defined 7 semantic color tokens with light/dark variants (`bg-status-new`, `bg-tag-global`, `text-success`). No file in the codebase uses any of them. Pages use raw Tailwind colors (`bg-blue-500`, `text-green-600`).

## Significant Issues

### 3. Button Component Not Adopted by Pages

The Button component was standardized with compact default (h-8) but only 2 sidebar components use it. All 6 pages build buttons from raw `<button>` HTML elements with manual styling.

### 4. DataTable Is Fully Orphaned

Created in Phase 5, documented in Phase 7, imported by nothing. DeckTable uses its own implementation.

### 5. hsl() Wrapping oklch() Values

Three chart components (`DashboardCharts.tsx`, `HighlightEditModal.tsx`, `HighlightHistoryModal.tsx`) use `hsl(var(--...))` but CSS variables contain oklch values. This is a **functional color rendering bug**.

### 6. Guide Documents Aspirational Rules

The "Rules and Anti-Patterns" section lists 6 rules; 3 are violated throughout the codebase:
- "No hardcoded spacing" — violated on every page
- "No raw text sizes" — violated on every page (100+ instances of raw `text-sm`/`text-xs`)
- "No manual button sizing" — violated on every page

## Tech Debt Summary

| Phase | Items | Severity |
|-------|-------|----------|
| 4. Token Foundation | 5 orphaned token categories | Medium |
| 5. Component Standardization | 3 underused/orphaned components | Medium |
| 6. Page Migration | 6 categories of incomplete migration | High |
| 7. Design Guide | 2 accuracy issues | Low |

**Total: 16 items across 4 phases**

---
*Audited: 2026-01-28*
*Auditor: Claude (gsd-audit-milestone)*
